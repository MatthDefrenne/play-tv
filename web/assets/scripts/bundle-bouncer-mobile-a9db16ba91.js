!function(){function e(t,i,s){function r(n,o){if(!i[n]){if(!t[n]){var l="function"==typeof require&&require;if(!o&&l)return l(n,!0);if(a)return a(n,!0);var d=new Error("Cannot find module '"+n+"'");throw d.code="MODULE_NOT_FOUND",d}var u=i[n]={exports:{}};t[n][0].call(u.exports,function(e){var i=t[n][1][e];return r(i||e)},u,u.exports,e,t,i,s)}return i[n].exports}for(var a="function"==typeof require&&require,n=0;n<s.length;n++)r(s[n]);return r}return e}()({1:[function(e,t,i){t.exports=window.ptv=window.ptv||{}},{}],2:[function(e,t,i){var s=e("./_global-legacy"),r=e("./views-mobile/account-login/index"),a=e("./views-mobile/account-register/index"),n=e("./views-mobile/account-password/forgot"),o=e("./views-mobile/account-password/reinitialise");s.Utils.Themer.update("grey"),new r,new a,new n,new o},{"./_global-legacy":1,"./views-mobile/account-login/index":3,"./views-mobile/account-password/forgot":4,"./views-mobile/account-password/reinitialise":5,"./views-mobile/account-register/index":6}],3:[function(e,t,i){var s=e("./../base"),r=e("./../account/facebook");t.exports=s.extend({el:".pmd-js-Content",events:{"submit .pmd-js-Login-form":"submitForm"},initialize:function(){var e=this;return new r(_.bind(e.loginDone,e),_.bind(e.loginFail,e)),e.$alert=e.$(".pmd-js-Login-alert"),e.$buttonSubmit=this.$(".pmd-js-Login-buttonSubmit"),e.laddaSubmit=Ladda.create(this.$buttonSubmit[0]),e},submitForm:function(e){e.preventDefault();var t=this,i=e.target,s=$(i),r=s.serializeObject();t.laddaSubmit.start(),$.ajax({url:s.attr("action"),type:s.attr("method"),dataType:"json",data:r}).always(function(){t.laddaSubmit.stop()}).done(_.bind(t.loginDone,t)).fail(_.bind(t.loginFail,t))},loginDone:function(){"referrer"in document?window.location.replace(document.referrer):window.history.go(-1)},loginFail:function(e){var t=this,i="Oops, une erreur est survenue.";if(_.isObject(e.responseJSON)){var s=e.responseJSON,r=document.createElement("ul");_.each(s,function(e){var t=document.createElement("li");t.innerHTML=e,r.appendChild(t)}),i=r}t.$alert.html(i),t.displayErrorAlert()},displayAlert:function(){this.$alert.removeClass("pmd-Alert--success"),this.$alert.removeClass("pmd-Alert--error"),this.$alert.removeClass("pmd-Alert--hidden")},hideAlert:function(){this.$alert.addClass("pmd-Alert--hidden")},displayErrorAlert:function(){this.displayAlert(),this.$alert.addClass("pmd-Alert--error")},displaySuccessAlert:function(){this.displayAlert(),this.$alert.addClass("pmd-Alert--success")}})},{"./../account/facebook":7,"./../base":8}],4:[function(e,t,i){var s=e("./../base");t.exports=s.extend({el:".pmd-js-Content",events:{"submit .pmd-js-ForgotPassword-form":"submitForm"},initialize:function(){return this.$alert=this.$(".pmd-js-ForgotPassword-alert"),this.$buttonSubmit=this.$(".pmd-js-ForgotPassword-buttonSubmit"),this.laddaSubmit=Ladda.create(this.$buttonSubmit[0]),this},submitForm:function(e){e.preventDefault();var t=this,i=e.target,s=$(i),r=s.serializeObject();t.laddaSubmit.start(),$.ajax({url:s.attr("action"),type:"post",dataType:"json",data:r}).always(function(){t.laddaSubmit.stop()}).done(_.bind(t.askPasswordDone,t)).fail(_.bind(t.askPasswordFail,t))},askPasswordDone:function(){var e=this,t="Un email vient de vous être envoyé avec les informations nécessaires pour réinitialiser votre mot de passe.";e.$alert.html(t),e.displaySuccessAlert()},askPasswordFail:function(e){var t=this,i="Oops, une erreur est survenue.";if(_.isObject(e.responseJSON)){var s=e.responseJSON,r=document.createElement("ul");_.each(s,function(e){var t=document.createElement("li");t.innerHTML=e,r.appendChild(t)}),i=r}t.$alert.html(i),t.displayErrorAlert()},displayAlert:function(){this.$alert.removeClass("pmd-Alert--success"),this.$alert.removeClass("pmd-Alert--error"),this.$alert.removeClass("pmd-Alert--hidden")},hideAlert:function(){this.$alert.addClass("pmd-Alert--hidden")},displaySuccessAlert:function(){this.displayAlert(),this.$alert.addClass("pmd-Alert--success")},displayErrorAlert:function(){this.displayAlert(),this.$alert.addClass("pmd-Alert--error")}})},{"./../base":8}],5:[function(e,t,i){var s=e("./../base");t.exports=s.extend({el:".pmd-js-Content",events:{"submit .pmd-js-ReinitialisePassword-form":"submitForm"},initialize:function(){return this.$alert=this.$(".pmd-js-ReinitialisePassword-alert"),this.$buttonSubmit=this.$(".pmd-js-ReinitialisePassword-buttonSubmit"),this.laddaSubmit=Ladda.create(this.$buttonSubmit[0]),this},submitForm:function(e){e.preventDefault();var t=this,i=e.target,s=$(i),r=s.serializeObject();t.laddaSubmit.start(),$.ajax({url:s.attr("action"),type:"post",dataType:"json",data:r}).always(function(){t.laddaSubmit.stop()}).done(_.bind(t.reinitialisePasswordDone,t)).fail(_.bind(t.reinitialisePasswordFail,t))},reinitialisePasswordDone:function(){var e=this,t="Votre mot de passe a bien été mis à jour. Vous pouvez vous connecter dès à présent.";e.$alert.html(t),e.displaySuccessAlert()},reinitialisePasswordFail:function(e){var t=this,i="Oops, une erreur est survenue.";if(_.isObject(e.responseJSON)){var s=e.responseJSON,r=document.createElement("ul");_.each(s,function(e){var t=document.createElement("li");t.innerHTML=e,r.appendChild(t)}),i=r}t.$alert.html(i),t.displayErrorAlert()},displayAlert:function(){this.$alert.removeClass("pmd-Alert--success"),this.$alert.removeClass("pmd-Alert--error"),this.$alert.removeClass("pmd-Alert--hidden")},hideAlert:function(){this.$alert.addClass("pmd-Alert--hidden")},displaySuccessAlert:function(){this.displayAlert(),this.$alert.addClass("pmd-Alert--success")},displayErrorAlert:function(){this.displayAlert(),this.$alert.addClass("pmd-Alert--error")}})},{"./../base":8}],6:[function(e,t,i){var s=e("./../base"),r=e("./../account/facebook");t.exports=s.extend({el:".pmd-js-Content",events:{"submit .pmd-js-Register-form":"submitForm"},initialize:function(){_gaq.push(["_trackEvent","ACCOUNT","EMAIL","click"]);var e=this;return new r(_.bind(e.registerDone,e),_.bind(e.registerFail,e)),e.$alert=e.$(".pmd-js-Register-alert"),e.$buttonSubmit=this.$(".pmd-js-Register-buttonSubmit"),e.laddaSubmit=Ladda.create(this.$buttonSubmit[0]),e},submitForm:function(e){e.preventDefault();var t=this,i=e.target,s=$(i),r=s.serializeObject();"undefined"==typeof r.cgv&&(r.cgv=!1),"undefined"==typeof r.gender&&(r.gender=!1),t.laddaSubmit.start(),$.ajax({url:s.attr("action"),type:s.attr("method"),dataType:"json",data:r}).always(function(){t.laddaSubmit.stop()}).done(_.bind(t.registerDone,t)).fail(_.bind(t.registerFail,t))},registerDone:function(){var e=this,t="Félicitations, vous venez de vous inscrire. Vous allez recevoir un mail de confirmation.";e.$alert.html(t),e.displaySuccessAlert(),_gaq.push(["_trackEvent","ACCOUNT","EMAIL","confirmation_email"]),window.setTimeout(function(){window.location.assign("/television/")},3e3)},registerFail:function(e){var t=this,i="Oops, une erreur est survenue.";if(_.isObject(e.responseJSON)){var s=e.responseJSON,r=document.createElement("ul");_.each(s,function(e){var t=document.createElement("li");t.innerHTML=e,r.appendChild(t)}),i=r}t.$alert.html(i),t.displayErrorAlert()},displayAlert:function(){this.$alert.removeClass("pmd-Alert--success"),this.$alert.removeClass("pmd-Alert--error"),this.$alert.removeClass("pmd-Alert--hidden")},hideAlert:function(){this.$alert.addClass("pmd-Alert--hidden")},displayErrorAlert:function(){this.displayAlert(),this.$alert.addClass("pmd-Alert--error")},displaySuccessAlert:function(){this.displayAlert(),this.$alert.addClass("pmd-Alert--success")}})},{"./../account/facebook":7,"./../base":8}],7:[function(e,t,i){var s=e("./../base");t.exports=s.extend({el:".pmd-js-FacebookAction",events:{click:"dialog"},initialize:function(e,t){this.done=e,this.fail=t},dialog:function(e){var t=this;t.ladda=Ladda.create(this.el),t.ladda.start(),FB.login(_.bind(t.loginStatus,t),{scope:window.facebookScope.join(",")}),_gaq.push(["_trackEvent","ACCOUNT","FACEBOOK","click"]),e.preventDefault(),window.setTimeout(function(){t.ladda.stop()},2e3)},loginStatus:function(e){var t=this;e&&"connected"===e.status?FB.api("/me",{fields:"id,first_name,last_name,gender,email"},function(i){t.handleOauthFlow(i,e.authResponse)}):_gaq.push(["_trackEvent","ACCOUNT","FACEBOOK","abort"])},handleOauthFlow:function(e,t){var i=this;_.assign(e,t),$.ajax({url:"/oauth/facebook/",type:"post",data:e}).done(function(e){i.done(),"undefined"!=typeof e.flow&&_gaq.push(["_trackEvent","ACCOUNT","FACEBOOK",e.flow])}).fail(function(){i.fail()})}})},{"./../base":8}],8:[function(e,t,i){var s=window.Backbone;t.exports=s.View.extend({elements:null,constructor:function(){s.View.apply(this,arguments)},storeElements:function(){var e=this.elements;null!==e&&"object"==typeof e&&Object.keys(e).forEach(function(t){this["$"+t]=this.$(e[t]),this[t]=this.$(e[t])[0]},this)},close:function(){this.stopListening(),this.undelegateEvents()}})},{}]},{},[2]);